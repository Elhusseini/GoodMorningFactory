<UserControl x:Class="GoodMorningFactory.UI.Views.ReportsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="700" d:DesignWidth="900"
             FlowDirection="RightToLeft">
    <Grid>
        <TabControl>

            <!-- ==================== تقرير المبيعات ==================== -->
            <TabItem Header="تقرير المبيعات">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="0" Style="{DynamicResource FilterBorderStyle}">
                        <StackPanel Orientation="Horizontal">
                            <Label Content="من تاريخ:" VerticalAlignment="Center"/>
                            <DatePicker x:Name="SalesFromDatePicker" Width="120"/>
                            <Label Content="إلى تاريخ:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                            <DatePicker x:Name="SalesToDatePicker" Width="120"/>
                            <Button x:Name="GenerateSalesReportButton" Content="توليد التقرير" Margin="20,0,0,0" Click="GenerateSalesReportButton_Click" Style="{DynamicResource PrimaryButtonStyle}"/>
                            <Button x:Name="ExportSalesToPdfButton" Content="تصدير PDF" Margin="10,0,0,0" Click="ExportSalesToPdfButton_Click" Style="{DynamicResource SecondaryButtonStyle}"/>
                        </StackPanel>
                    </Border>
                    <DataGrid x:Name="SalesReportDataGrid" Grid.Row="1" Margin="0,10,0,0" IsReadOnly="True" AutoGenerateColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="رقم الفاتورة" Binding="{Binding InvoiceNumber}" Width="*"/>
                            <DataGridTextColumn Header="تاريخ البيع" Binding="{Binding SaleDate, StringFormat='g'}" Width="*"/>
                            <DataGridTextColumn Header="المبلغ المدفوع" Binding="{Binding AmountPaid, StringFormat='C'}" Width="*"/>
                            <DataGridTextColumn Header="إجمالي المبلغ" Binding="{Binding TotalAmount, StringFormat='C'}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    <Border Grid.Row="2" Style="{DynamicResource TotalsBorderStyle}" Margin="0,10,0,0">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <TextBlock Text="إجمالي المبيعات:" Style="{DynamicResource TotalLabelStyle}"/>
                            <TextBlock x:Name="TotalSalesTextBlock" Style="{DynamicResource TotalValueStyle}"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== تقرير المشتريات ==================== -->
            <TabItem Header="تقرير المشتريات">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="0" Style="{DynamicResource FilterBorderStyle}">
                        <StackPanel Orientation="Horizontal">
                            <Label Content="من تاريخ:" VerticalAlignment="Center"/>
                            <DatePicker x:Name="PurchasesFromDatePicker" Width="120"/>
                            <Label Content="إلى تاريخ:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                            <DatePicker x:Name="PurchasesToDatePicker" Width="120"/>
                            <Button x:Name="GeneratePurchasesReportButton" Content="توليد التقرير" Margin="20,0,0,0" Click="GeneratePurchasesReportButton_Click" Style="{DynamicResource PrimaryButtonStyle}"/>
                            <Button x:Name="ExportPurchasesToPdfButton" Content="تصدير PDF" Margin="10,0,0,0" Click="ExportPurchasesToPdfButton_Click" Style="{DynamicResource SecondaryButtonStyle}"/>
                        </StackPanel>
                    </Border>
                    <DataGrid x:Name="PurchasesReportDataGrid" Grid.Row="1" Margin="0,10,0,0" IsReadOnly="True" AutoGenerateColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="رقم الفاتورة" Binding="{Binding InvoiceNumber}" Width="*"/>
                            <DataGridTextColumn Header="المورد" Binding="{Binding Supplier.Name}" Width="*"/>
                            <DataGridTextColumn Header="تاريخ الشراء" Binding="{Binding PurchaseDate, StringFormat='d'}" Width="*"/>
                            <DataGridTextColumn Header="إجمالي المبلغ" Binding="{Binding TotalAmount, StringFormat='C'}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    <Border Grid.Row="2" Style="{DynamicResource TotalsBorderStyle}" Margin="0,10,0,0">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <TextBlock Text="إجمالي المشتريات:" Style="{DynamicResource TotalLabelStyle}"/>
                            <TextBlock x:Name="TotalPurchasesTextBlock" Style="{DynamicResource TotalValueStyle}"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== تقرير المخزون ==================== -->
            <TabItem Header="تقرير المخزون">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Button x:Name="ExportInventoryToPdfButton" Content="تصدير PDF" Grid.Row="0" HorizontalAlignment="Left" Click="ExportInventoryToPdfButton_Click" Style="{DynamicResource SecondaryButtonStyle}"/>
                    <DataGrid x:Name="InventoryReportDataGrid" Grid.Row="1" Margin="0,10,0,0" IsReadOnly="True" AutoGenerateColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="كود المنتج" Binding="{Binding ProductCode}" Width="*"/>
                            <DataGridTextColumn Header="اسم المنتج" Binding="{Binding ProductName}" Width="2*"/>
                            <DataGridTextColumn Header="التصنيف" Binding="{Binding CategoryName}" Width="*"/>
                            <DataGridTextColumn Header="الكمية الحالية" Binding="{Binding QuantityOnHand}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- ==================== تقرير دفتر الأستاذ العام ==================== -->
            <TabItem Header="دفتر الأستاذ العام">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="0" Style="{DynamicResource FilterBorderStyle}">
                        <StackPanel Orientation="Horizontal">
                            <Label Content="الحساب:" VerticalAlignment="Center"/>
                            <ComboBox x:Name="GlAccountComboBox" Width="200" DisplayMemberPath="AccountName" SelectedValuePath="Id"/>
                            <Label Content="من تاريخ:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                            <DatePicker x:Name="GlFromDatePicker" Width="120"/>
                            <Label Content="إلى تاريخ:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                            <DatePicker x:Name="GlToDatePicker" Width="120"/>
                            <Button x:Name="GenerateGlReportButton" Content="توليد التقرير" Margin="20,0,0,0" Click="GenerateGlReportButton_Click" Style="{DynamicResource PrimaryButtonStyle}"/>
                        </StackPanel>
                    </Border>
                    <DataGrid x:Name="GlReportDataGrid" Grid.Row="1" Margin="0,10,0,0" IsReadOnly="True" AutoGenerateColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="التاريخ" Binding="{Binding Date, StringFormat='d'}" Width="*"/>
                            <DataGridTextColumn Header="رقم القيد" Binding="{Binding VoucherNumber}" Width="*"/>
                            <DataGridTextColumn Header="الوصف" Binding="{Binding Description}" Width="2*"/>
                            <DataGridTextColumn Header="مدين" Binding="{Binding Debit, StringFormat='N2'}" Width="*"/>
                            <DataGridTextColumn Header="دائن" Binding="{Binding Credit, StringFormat='N2'}" Width="*"/>
                            <DataGridTemplateColumn Header="الرصيد" Width="*">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Balance, StringFormat='N2'}" Foreground="{Binding Balance, Converter={StaticResource AmountToColorConverter}}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                    <Border Grid.Row="2" Style="{DynamicResource TotalsBorderStyle}" Margin="0,10,0,0">
                        <WrapPanel HorizontalAlignment="Right">
                            <TextBlock Text="الرصيد الافتتاحي:" Style="{DynamicResource TotalLabelStyle}"/>
                            <TextBlock x:Name="OpeningBalanceRun" Style="{DynamicResource TotalValueStyle}"/>
                            <TextBlock Text="إجمالي المدين:" Style="{DynamicResource TotalLabelStyle}" Margin="20,5,5,5"/>
                            <TextBlock x:Name="TotalDebitRun" Style="{DynamicResource TotalValueStyle}"/>
                            <TextBlock Text="إجمالي الدائن:" Style="{DynamicResource TotalLabelStyle}" Margin="20,5,5,5"/>
                            <TextBlock x:Name="TotalCreditRun" Style="{DynamicResource TotalValueStyle}"/>
                            <TextBlock Text="الرصيد الختامي:" Style="{DynamicResource TotalLabelStyle}" Margin="20,5,5,5"/>
                            <TextBlock x:Name="ClosingBalanceRun" Style="{DynamicResource TotalValueStyle}"/>
                        </WrapPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== تقرير ميزان المراجعة ==================== -->
            <TabItem Header="ميزان المراجعة">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="0" Style="{DynamicResource FilterBorderStyle}">
                        <StackPanel Orientation="Horizontal">
                            <Label Content="حتى تاريخ:" VerticalAlignment="Center"/>
                            <DatePicker x:Name="TbDatePicker" Width="120"/>
                            <Button x:Name="GenerateTbReportButton" Content="توليد التقرير" Margin="20,0,0,0" Click="GenerateTbReportButton_Click" Style="{DynamicResource PrimaryButtonStyle}"/>
                        </StackPanel>
                    </Border>
                    <DataGrid x:Name="TbReportDataGrid" Grid.Row="1" Margin="0,10,0,0" IsReadOnly="True" AutoGenerateColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="رقم الحساب" Binding="{Binding AccountNumber}" Width="*"/>
                            <DataGridTextColumn Header="اسم الحساب" Binding="{Binding AccountName}" Width="2*"/>
                            <DataGridTextColumn Header="رصيد مدين" Binding="{Binding DebitBalance, StringFormat='N2'}" Width="*"/>
                            <DataGridTextColumn Header="رصيد دائن" Binding="{Binding CreditBalance, StringFormat='N2'}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    <Border Grid.Row="2" Style="{DynamicResource TotalsBorderStyle}" Margin="0,10,0,0">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <TextBlock Text="الإجمالي:" Style="{DynamicResource TotalLabelStyle}"/>
                            <TextBlock Text="المدين:" Margin="10,5,5,5" FontWeight="Bold"/>
                            <TextBlock x:Name="TbTotalDebitRun" Style="{DynamicResource TotalValueStyle}"/>
                            <TextBlock Text="الدائن:" Margin="20,5,5,5" FontWeight="Bold"/>
                            <TextBlock x:Name="TbTotalCreditRun" Style="{DynamicResource TotalValueStyle}"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== تقرير قائمة الدخل ==================== -->
            <TabItem Header="قائمة الدخل">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="0" Style="{DynamicResource FilterBorderStyle}">
                        <StackPanel Orientation="Horizontal">
                            <Label Content="من تاريخ:" VerticalAlignment="Center"/>
                            <DatePicker x:Name="IsFromDatePicker" Width="120"/>
                            <Label Content="إلى تاريخ:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                            <DatePicker x:Name="IsToDatePicker" Width="120"/>
                            <Button x:Name="GenerateIsReportButton" Content="توليد التقرير" Margin="20,0,0,0" Click="GenerateIsReportButton_Click" Style="{DynamicResource PrimaryButtonStyle}"/>
                        </StackPanel>
                    </Border>
                    <Grid Grid.Row="1" Margin="0,10,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <GroupBox Header="الإيرادات" Grid.Column="0">
                            <DataGrid x:Name="RevenueDataGrid" IsReadOnly="True" AutoGenerateColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="الحساب" Binding="{Binding AccountName}" Width="*"/>
                                    <DataGridTextColumn Header="الرصيد" Binding="{Binding Balance, StringFormat='N2'}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </GroupBox>
                        <GroupBox Header="المصروفات" Grid.Column="1" Margin="10,0,0,0">
                            <DataGrid x:Name="ExpenseDataGrid" IsReadOnly="True" AutoGenerateColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="الحساب" Binding="{Binding AccountName}" Width="*"/>
                                    <DataGridTextColumn Header="الرصيد" Binding="{Binding Balance, StringFormat='N2'}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </GroupBox>
                    </Grid>
                    <Border Grid.Row="2" Style="{DynamicResource TotalsBorderStyle}" Margin="0,10,0,0">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <TextBlock Text="صافي الربح / الخسارة:" Style="{DynamicResource TotalLabelStyle}" FontSize="16"/>
                            <TextBlock x:Name="NetProfitLossRun" Style="{DynamicResource TotalValueStyle}" FontSize="16"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== تقرير الميزانية العمومية ==================== -->
            <TabItem Header="الميزانية العمومية">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="0" Style="{DynamicResource FilterBorderStyle}">
                        <StackPanel Orientation="Horizontal">
                            <Label Content="في تاريخ:" VerticalAlignment="Center"/>
                            <DatePicker x:Name="BsDatePicker" Width="120"/>
                            <Button x:Name="GenerateBsReportButton" Content="توليد التقرير" Margin="20,0,0,0" Click="GenerateBsReportButton_Click" Style="{DynamicResource PrimaryButtonStyle}"/>
                        </StackPanel>
                    </Border>
                    <Grid Grid.Row="1" Margin="0,10,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <GroupBox Header="الأصول" Grid.Column="0">
                            <TreeView x:Name="AssetsTreeView" ItemsSource="{Binding}">
                                <TreeView.ItemTemplate>
                                    <HierarchicalDataTemplate ItemsSource="{Binding SubAccounts}">
                                        <StackPanel Orientation="Horizontal" Margin="{Binding IndentLevel, Converter={StaticResource IndentConverter}}">
                                            <TextBlock Text="{Binding AccountName}" FontWeight="{Binding IsTotal, Converter={StaticResource BoolToFontWeightConverter}}"/>
                                            <TextBlock Text="{Binding Balance, StringFormat=' {0:N2}'}" Margin="10,0,0,0"/>
                                        </StackPanel>
                                    </HierarchicalDataTemplate>
                                </TreeView.ItemTemplate>
                            </TreeView>
                        </GroupBox>
                        <StackPanel Grid.Column="1" Margin="10,0,0,0">
                            <GroupBox Header="الخصوم">
                                <TreeView x:Name="LiabilitiesTreeView" ItemsSource="{Binding}">
                                    <TreeView.ItemTemplate>
                                        <HierarchicalDataTemplate ItemsSource="{Binding SubAccounts}">
                                            <StackPanel Orientation="Horizontal" Margin="{Binding IndentLevel, Converter={StaticResource IndentConverter}}">
                                                <TextBlock Text="{Binding AccountName}" FontWeight="{Binding IsTotal, Converter={StaticResource BoolToFontWeightConverter}}"/>
                                                <TextBlock Text="{Binding Balance, StringFormat=' {0:N2}'}" Margin="10,0,0,0"/>
                                            </StackPanel>
                                        </HierarchicalDataTemplate>
                                    </TreeView.ItemTemplate>
                                </TreeView>
                            </GroupBox>
                            <GroupBox Header="حقوق الملكية" Margin="0,10,0,0">
                                <TreeView x:Name="EquityTreeView" ItemsSource="{Binding}">
                                    <TreeView.ItemTemplate>
                                        <HierarchicalDataTemplate ItemsSource="{Binding SubAccounts}">
                                            <StackPanel Orientation="Horizontal" Margin="{Binding IndentLevel, Converter={StaticResource IndentConverter}}">
                                                <TextBlock Text="{Binding AccountName}" FontWeight="{Binding IsTotal, Converter={StaticResource BoolToFontWeightConverter}}"/>
                                                <TextBlock Text="{Binding Balance, StringFormat=' {0:N2}'}" Margin="10,0,0,0"/>
                                            </StackPanel>
                                        </HierarchicalDataTemplate>
                                    </TreeView.ItemTemplate>
                                </TreeView>
                            </GroupBox>
                        </StackPanel>
                    </Grid>
                    <Border Grid.Row="2" Style="{DynamicResource TotalsBorderStyle}" Margin="0,10,0,0">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <TextBlock Text="إجمالي الأصول:" Style="{DynamicResource TotalLabelStyle}"/>
                            <TextBlock x:Name="TotalAssetsRun" Style="{DynamicResource TotalValueStyle}"/>
                            <TextBlock Text="إجمالي الخصوم وحقوق الملكية:" Style="{DynamicResource TotalLabelStyle}" Margin="20,5,5,5"/>
                            <TextBlock x:Name="TotalLiabilitiesAndEquityRun" Style="{DynamicResource TotalValueStyle}"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== تقرير قائمة التدفقات النقدية ==================== -->
            <TabItem Header="التدفقات النقدية">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="0" Style="{DynamicResource FilterBorderStyle}">
                        <StackPanel Orientation="Horizontal">
                            <Label Content="من تاريخ:" VerticalAlignment="Center"/>
                            <DatePicker x:Name="CfFromDatePicker" Width="120"/>
                            <Label Content="إلى تاريخ:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                            <DatePicker x:Name="CfToDatePicker" Width="120"/>
                            <Button x:Name="GenerateCashFlowReportButton" Content="توليد التقرير" Margin="20,0,0,0" Click="GenerateCashFlowReportButton_Click" Style="{DynamicResource PrimaryButtonStyle}"/>
                        </StackPanel>
                    </Border>
                    <DataGrid x:Name="CashFlowDataGrid" Grid.Row="1" Margin="0,10,0,0" IsReadOnly="True" AutoGenerateColumns="False" HeadersVisibility="None">
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Width="*">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Item}" Margin="{Binding IndentLevel, Converter={StaticResource IndentConverter}}" FontWeight="{Binding IsTotal, Converter={StaticResource BoolToFontWeightConverter}}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Width="150">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Amount, StringFormat='N2'}" HorizontalAlignment="Right" Foreground="{Binding Amount, Converter={StaticResource AmountToColorConverter}}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- ==================== تقارير الإنتاج ==================== -->
            <TabItem Header="تقارير الإنتاج">
                <TabControl>
                    <!-- تقرير أوامر العمل -->
                    <TabItem Header="أوامر العمل">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Style="{DynamicResource FilterBorderStyle}">
                                <StackPanel Orientation="Horizontal">
                                    <Label Content="من تاريخ:" VerticalAlignment="Center"/>
                                    <DatePicker x:Name="WoFromDatePicker" Width="120"/>
                                    <Label Content="إلى تاريخ:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                    <DatePicker x:Name="WoToDatePicker" Width="120"/>
                                    <Label Content="الحالة:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                    <ComboBox x:Name="WoStatusFilterComboBox" Width="150" ItemStringFormat="{Binding Converter={StaticResource EnumToDescriptionConverter}}"/>
                                    <Button x:Name="GenerateWoReportButton" Content="توليد التقرير" Margin="20,0,0,0" Click="GenerateWoReportButton_Click" Style="{DynamicResource PrimaryButtonStyle}"/>
                                </StackPanel>
                            </Border>
                            <DataGrid x:Name="WoReportDataGrid" Grid.Row="1" Margin="0,10,0,0" IsReadOnly="True" AutoGenerateColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="رقم الأمر" Binding="{Binding WorkOrderNumber}" Width="*"/>
                                    <DataGridTextColumn Header="المنتج" Binding="{Binding FinishedGood.Name}" Width="2*"/>
                                    <DataGridTextColumn Header="الكمية المطلوبة" Binding="{Binding QuantityToProduce}" Width="*"/>
                                    <DataGridTextColumn Header="الكمية المنتجة" Binding="{Binding QuantityProduced}" Width="*"/>
                                    <DataGridTextColumn Header="تاريخ البدء المخطط" Binding="{Binding PlannedStartDate, StringFormat='d'}" Width="*"/>
                                    <DataGridTextColumn Header="الحالة" Binding="{Binding Status, Converter={StaticResource EnumToDescriptionConverter}}" Width="*"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                    <!-- تقرير تكاليف الإنتاج -->
                    <TabItem Header="تكاليف الإنتاج">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Style="{DynamicResource FilterBorderStyle}">
                                <StackPanel Orientation="Horizontal">
                                    <Label Content="من تاريخ:" VerticalAlignment="Center"/>
                                    <DatePicker x:Name="PcFromDatePicker" Width="120"/>
                                    <Label Content="إلى تاريخ:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                    <DatePicker x:Name="PcToDatePicker" Width="120"/>
                                    <Button x:Name="GeneratePcReportButton" Content="توليد التقرير" Margin="20,0,0,0" Click="GeneratePcReportButton_Click" Style="{DynamicResource PrimaryButtonStyle}"/>
                                </StackPanel>
                            </Border>
                            <DataGrid x:Name="PcReportDataGrid" Grid.Row="1" Margin="0,10,0,0" IsReadOnly="True" AutoGenerateColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="رقم الأمر" Binding="{Binding WorkOrderNumber}" Width="*"/>
                                    <DataGridTextColumn Header="المنتج" Binding="{Binding ProductName}" Width="2*"/>
                                    <DataGridTextColumn Header="الكمية المنتجة" Binding="{Binding ProducedQuantity}" Width="*"/>
                                    <DataGridTextColumn Header="تاريخ الإكمال" Binding="{Binding CompletionDate, StringFormat='d'}" Width="*"/>
                                    <DataGridTextColumn Header="تكلفة المواد" Binding="{Binding TotalMaterialCost, StringFormat='N2'}" Width="*"/>
                                    <DataGridTextColumn Header="تكلفة العمالة" Binding="{Binding TotalLaborCost, StringFormat='N2'}" Width="*"/>
                                    <DataGridTextColumn Header="التكلفة الإجمالية" Binding="{Binding TotalCost, StringFormat='N2'}" Width="*"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                    <!-- تقرير استهلاك المواد -->
                    <TabItem Header="استهلاك المواد">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Style="{DynamicResource FilterBorderStyle}">
                                <StackPanel Orientation="Horizontal">
                                    <Label Content="أمر العمل:" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="McWorkOrderComboBox" Width="200" DisplayMemberPath="WorkOrderNumber" SelectedValuePath="Id" SelectionChanged="McWorkOrderComboBox_SelectionChanged"/>
                                </StackPanel>
                            </Border>
                            <DataGrid x:Name="McReportDataGrid" Grid.Row="1" Margin="0,10,0,0" IsReadOnly="True" AutoGenerateColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="المادة الخام" Binding="{Binding MaterialName}" Width="2*"/>
                                    <DataGridTextColumn Header="الكمية المخططة" Binding="{Binding PlannedQuantity, StringFormat='N2'}" Width="*"/>
                                    <DataGridTextColumn Header="الكمية الفعلية" Binding="{Binding ActualQuantity, StringFormat='N2'}" Width="*"/>
                                    <DataGridTemplateColumn Header="الفرق" Width="*">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Variance, StringFormat='N2'}" Foreground="{Binding Variance, Converter={StaticResource AmountToColorConverter}}"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                    <!-- تقرير كفاءة الإنتاج -->
                    <TabItem Header="كفاءة الإنتاج">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Style="{DynamicResource FilterBorderStyle}">
                                <StackPanel Orientation="Horizontal">
                                    <Label Content="من تاريخ:" VerticalAlignment="Center"/>
                                    <DatePicker x:Name="EffFromDatePicker" Width="120"/>
                                    <Label Content="إلى تاريخ:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                    <DatePicker x:Name="EffToDatePicker" Width="120"/>
                                    <Button x:Name="GenerateEffReportButton" Content="توليد التقرير" Margin="20,0,0,0" Click="GenerateEffReportButton_Click" Style="{DynamicResource PrimaryButtonStyle}"/>
                                </StackPanel>
                            </Border>
                            <DataGrid x:Name="EffReportDataGrid" Grid.Row="1" Margin="0,10,0,0" IsReadOnly="True" AutoGenerateColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="رقم الأمر" Binding="{Binding WorkOrderNumber}" Width="*"/>
                                    <DataGridTextColumn Header="المنتج" Binding="{Binding ProductName}" Width="2*"/>
                                    <DataGridTextColumn Header="المدة المخططة (أيام)" Binding="{Binding PlannedDurationDays, StringFormat='N1'}" Width="*"/>
                                    <DataGridTextColumn Header="المدة الفعلية (أيام)" Binding="{Binding ActualDurationDays, StringFormat='N1'}" Width="*"/>
                                    <DataGridTextColumn Header="الكفاءة" Binding="{Binding Efficiency}" Width="*"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                    <!-- تقرير الهدر -->
                    <TabItem Header="الهدر">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Style="{DynamicResource FilterBorderStyle}">
                                <StackPanel Orientation="Horizontal">
                                    <Label Content="من تاريخ:" VerticalAlignment="Center"/>
                                    <DatePicker x:Name="ScrapFromDatePicker" Width="120"/>
                                    <Label Content="إلى تاريخ:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                    <DatePicker x:Name="ScrapToDatePicker" Width="120"/>
                                    <Button x:Name="GenerateScrapReportButton" Content="توليد التقرير" Margin="20,0,0,0" Click="GenerateScrapReportButton_Click" Style="{DynamicResource PrimaryButtonStyle}"/>
                                </StackPanel>
                            </Border>
                            <DataGrid x:Name="ScrapReportDataGrid" Grid.Row="1" Margin="0,10,0,0" IsReadOnly="True" AutoGenerateColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="رقم الأمر" Binding="{Binding WorkOrderNumber}" Width="*"/>
                                    <DataGridTextColumn Header="المنتج" Binding="{Binding ProductName}" Width="2*"/>
                                    <DataGridTextColumn Header="الكمية" Binding="{Binding Quantity}" Width="*"/>
                                    <DataGridTextColumn Header="السبب" Binding="{Binding Reason}" Width="2*"/>
                                    <DataGridTextColumn Header="التاريخ" Binding="{Binding Date, StringFormat='d'}" Width="*"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                </TabControl>
            </TabItem>

            <!-- ==================== تقرير مراكز التكلفة ==================== -->
            <TabItem Header="تقرير مراكز التكلفة">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="0" Style="{DynamicResource FilterBorderStyle}">
                        <StackPanel Orientation="Horizontal">
                            <Label Content="من تاريخ:" VerticalAlignment="Center"/>
                            <DatePicker x:Name="CcFromDatePicker" Width="120"/>
                            <Label Content="إلى تاريخ:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                            <DatePicker x:Name="CcToDatePicker" Width="120"/>
                            <Label Content="مركز التكلفة:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                            <ComboBox x:Name="CcFilterComboBox" Width="150" DisplayMemberPath="Name" SelectedValuePath="Id"/>
                            <Button x:Name="GenerateCcReportButton" Content="توليد التقرير" Margin="20,0,0,0" Click="GenerateCcReportButton_Click" Style="{DynamicResource PrimaryButtonStyle}"/>
                        </StackPanel>
                    </Border>
                    <DataGrid x:Name="CcReportDataGrid" Grid.Row="1" Margin="0,10,0,0" IsReadOnly="True" AutoGenerateColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="مركز التكلفة" Binding="{Binding CostCenterName}" Width="2*"/>
                            <DataGridTextColumn Header="إجمالي الإيرادات" Binding="{Binding TotalRevenueFormatted}" Width="*"/>
                            <DataGridTextColumn Header="إجمالي المصروفات" Binding="{Binding TotalExpensesFormatted}" Width="*"/>
                            <DataGridTemplateColumn Header="صافي الربح / الخسارة" Width="*">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding NetProfitLossFormatted}" Foreground="{Binding NetProfitLoss, Converter={StaticResource AmountToColorConverter}}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                    <Border Grid.Row="2" Style="{DynamicResource TotalsBorderStyle}" Margin="0,10,0,0">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <TextBlock Text="الإجمالي العام:" Style="{DynamicResource TotalLabelStyle}"/>
                            <TextBlock Text="الإيرادات:" Style="{DynamicResource TotalLabelStyle}"/>
                            <TextBlock x:Name="CcTotalRevenueRun" Style="{DynamicResource TotalValueStyle}"/>
                            <TextBlock Text="المصروفات:" Style="{DynamicResource TotalLabelStyle}" Margin="20,5,5,5"/>
                            <TextBlock x:Name="CcTotalExpenseRun" Style="{DynamicResource TotalValueStyle}"/>
                            <TextBlock Text="صافي الربح:" Style="{DynamicResource TotalLabelStyle}" Margin="20,5,5,5"/>
                            <TextBlock x:Name="CcTotalNetRun" Style="{DynamicResource TotalValueStyle}"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== تقرير الموازنة مقابل الفعلي ==================== -->
            <TabItem Header="الموازنة مقابل الفعلي">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="0" Style="{DynamicResource FilterBorderStyle}">
                        <StackPanel Orientation="Horizontal">
                            <Label Content="اختر الموازنة:" VerticalAlignment="Center"/>
                            <ComboBox x:Name="BudgetFilterComboBox" Width="200" DisplayMemberPath="Name" SelectedValuePath="Id"/>
                            <Label Content="عرض بيانات شهر:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                            <ComboBox x:Name="BudgetMonthFilterComboBox" Width="120" DisplayMemberPath="Name" SelectedValuePath="Month"/>
                            <Button x:Name="GenerateBudgetVsActualReportButton" Content="توليد التقرير" Margin="20,0,0,0" Click="GenerateBudgetVsActualReportButton_Click" Style="{DynamicResource PrimaryButtonStyle}"/>
                        </StackPanel>
                    </Border>
                    <DataGrid x:Name="BudgetVsActualDataGrid" Grid.Row="1" Margin="0,10,0,0" IsReadOnly="True" AutoGenerateColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="رقم الحساب" Binding="{Binding AccountNumber}" Width="Auto" FontWeight="SemiBold"/>
                            <DataGridTextColumn Header="اسم الحساب" Binding="{Binding AccountName}" Width="2*"/>
                            <DataGridTextColumn Header="المبلغ التقديري" Binding="{Binding BudgetedAmountFormatted}" Width="*" ElementStyle="{DynamicResource RightAlignedCellStyle}"/>
                            <DataGridTextColumn Header="المبلغ الفعلي" Binding="{Binding ActualAmountFormatted}" Width="*" ElementStyle="{DynamicResource RightAlignedCellStyle}"/>
                            <DataGridTemplateColumn Header="الانحراف" Width="*">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding VarianceFormatted}" HorizontalAlignment="Right" Foreground="{Binding Converter={StaticResource VarianceToColorConverter}}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="نسبة الانحراف" Width="*">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding VariancePercentageFormatted}" HorizontalAlignment="Right" Foreground="{Binding Converter={StaticResource VarianceToColorConverter}}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                    <Border Grid.Row="2" Style="{DynamicResource TotalsBorderStyle}" Margin="0,10,0,0">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <TextBlock Text="الإجمالي:" Style="{DynamicResource TotalLabelStyle}"/>
                            <TextBlock Text="التقديري:" Style="{DynamicResource TotalLabelStyle}"/>
                            <TextBlock x:Name="BudgetTotalRun" Style="{DynamicResource TotalValueStyle}"/>
                            <TextBlock Text="الفعلي:" Style="{DynamicResource TotalLabelStyle}" Margin="20,5,5,5"/>
                            <TextBlock x:Name="ActualTotalRun" Style="{DynamicResource TotalValueStyle}"/>
                            <TextBlock Text="الانحراف:" Style="{DynamicResource TotalLabelStyle}" Margin="20,5,5,5"/>
                            <TextBlock x:Name="VarianceTotalRun" Style="{DynamicResource TotalValueStyle}"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

        </TabControl>
    </Grid>
</UserControl>
